---
title: CVE-2019-1388
description: Exploitation d'une vulnérabilité dans l'UAC (User Account Control). Permet d'obtenir les privilèges système depuis la page d'information d'un certificat d'un fichier exécutable.
published: true
date: 2024-10-26T17:50:52.882Z
tags: windows, poc
editor: markdown
dateCreated: 2024-10-26T17:30:21.727Z
---

# Introduction

Exploitation d'une vulnérabilité dans l'UAC (User Account Control).

Lorsque le champ SpcSpAgencyInfo est spécifié dans le certificat d'un exécutable signé, alors un lien hypertexte cliquable est généré sur la page d'information du certificat. Ce lien ouvre un navigateur en tant que SYSTEM.

Versions Windows Server vulnérables
| Version | Vulnérable |
| -------- | ------- |
| Windows 2008r2 7601 | OUI |
| Windows 2012r2 9600 | OUI |
| Windows 2016 14393 | OUI |
| Windows 2019 17763 | NON |

Versions Windows Workstation vulnérables
| Version | Vulnérable |
| -------- | ------- |
| Windows 7 SP1 7601 | OUI |
| Windows 8 9200 | OUI |
| Windows 8.1 9600 | OUI |
| Windows 10 1511 10240 | OUI |
| Windows 10 1607 14393 | OUI |
| Windows 10 1703 15063 | NON |
| Windows 10 1709 16299 | NON |

# Exécution

- Télécharger ou créer un fichier exécutable signé et où le champ SpcSpAgencyInfo est présent dans le certificat de l'exécutable.
  Un fichier connu disposant d'un certificat avec le champ SpcSpAgencyInfo peuplé est hhupd.exe,
  il est disponible au téléchargement [ici](https://packetstormsecurity.com/files/14437/hhupd.exe.html).

> Le champ est identifié par l'OID 1.3.6.1.4.1.311.2.1.10 du certificat.
> {.is-info}

- Exécuter le fichier

- Lors de l'affichage de la fenêtre UAC, afficher les informations sur le certificat du fichier.

- Vérifier que le champ SpcSpAgencyInfo est peuplé dans les détails du certificat.

- Si le champ SpcSpAgencyInfo est peuplé, alors un lien hypertexte cliquable sera disponible dans la page principale du certificat.

- Lorsque ce lien est cliqué, il est ouvert dans le navigateur par défaut (qui est exécuté en tant que SYSTEM).

- Une fois dans le navigateur, il est possible d'avoir accès à un terminal sans trop de problèmes, pour cela, il est possible de sauvegarder une page web et lors du choix du dossier, entrer cmd.exe ou powershell.exe dans le chemin.

# Voir aussi

Page NIST de la vulnérabilité:
https://nvd.nist.gov/vuln/detail/CVE-2019-1388

Systèmes vulnérables
https://web.archive.org/web/20210620053630/https://gist.github.com/gentilkiwi/802c221c0731c06c22bb75650e884e5a
