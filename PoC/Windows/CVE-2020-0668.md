---
title: CVE-2020-0668
description: Utilise la vulnérabilité CVE-2020-0668 dans le traçage de services pour effectuer un déplacement de fichier en mode privilégié.
published: true
date: 2025-05-04T14:55:43.304Z
tags: windows, poc
editor: markdown
dateCreated: 2024-08-25T14:54:42.971Z
---

# Introduction

Utilise la vulnérabilité CVE-2020-0668 dans le traçage de services pour effectuer un déplacement de fichier en mode privilégié.

Le traçage de services (Service Tracing) est une fonction de Windows permettant de recueillir des informations de debug concernant les services.
N'importe quel utilisateur local peut éditer les paramètres concernant cette fonctionnalité en modifiant les clés de registre dans "HKLM\SOFTWARE\Microsoft\Tracing". (activer ou désactiver la fonctionnalité pour des services, spécifier le répertoire de sortie des logs ou encore la taille maximum du fichier de log...)
Si la taille maximum du fichier de log (.LOG) est atteinte, alors celui-ci est déplacé vers un .OLD.

La vulnérabilité se base sur le fait que si des liens symboliques sont crées à la place des fichiers (.LOG et .OLD), un fichier donné peut être déplacé dans n'importe quel emplacement.

> Il n'est pas possible de remplacer les fichiers Windows protégés.
> {.is-warning}

> le PoC de la vulnérabilité est disponible au téléchargement [ici](https://github.com/RedCursorSecurityConsulting/CVE-2020-0668)
> {.is-info}

# Syntaxe

`CVE-2020-0668.exe [fichier source] [fichier de destination]`

# Exemples

Déplace le fichier C:\test\test.dll vers C:\Windows\System32\privlib.dll
`CVE-2020-0668.exe C:\test\test.dll C:\Windows\System32\privlib.dll`

# Voir aussi

Explications détaillés de l'exploit:
https://itm4n.github.io/cve-2020-0668-windows-service-tracing-eop/
